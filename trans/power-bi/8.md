# 第八章电力 BI 网关:数据安全

如果我们拥有的数据源是内部的，我们就不能从 Power BI 自动更新，而是在云中运行。因此，我们需要在云中的内容和内部运行的内容之间实现一个通信通道。这可以通过 Power BI 提供的网关来实现。特别是，我们有个人网关和内部数据网关，都是免费的，可以直接从 Power BI 门户下载。

个人网关是一种 Windows 服务，可以作为 Windows 应用程序的数据源。如果用户是管理员，个人网关将使用安装它的用户的相同凭据作为 Windows 服务运行。但是如果用户不是机器的管理员，个人网关将作为 Windows 应用程序运行。个人网关服务作为 64 位窗口应用程序运行，使用 Azure 服务总线与 Power BI 通信，这允许数据传输的安全通道。在这里指定我们不需要在基础架构中打开防火墙端口来接受传入的连接是非常重要的，因为 Azure 服务总线在“中继”模式下工作，因此所有通信实体都是服务总线的客户端。这意味着我们必须对开放传出连接的可能性持开放态度，尽管传入连接不是必需的。这有点像所有用户都使用聊天客户端的聊天功能，但实际上他们之间的通信是双向的。

个人网关不能与其他网关结合运行，因此它必须是安装它的计算机上唯一的网关。它被称为个人网关，因为它是为个人使用。例如:每天使用 Excel 工作簿并决定在 Power BI 上加载工作簿的用户将需要数据刷新，因为他们在内部工作。我们可以通过在个人笔记本电脑中安装个人网关来达到同样的效果。个人网关将链接到安装它的用户的个人 Power BI 工作区。到那时，我们将能够完全按照工作簿在内部时的样子更新数据。但是如果我们考虑一个拥有更多用户，甚至 10 个用户的组织，他们每个人都应该安装自己的个人网关，这样他们就有能力更新数据。为了解决这个问题，我们提供了内部数据网关，它实际上是为企业环境设计的。

内部数据网关设计为全天候运行。查询结果通过 Azure 服务总线安全发送(SSL)。

![](../Images/image224.png)

图 195:电力商业智能网关规则

借助 Power BI，企业网关安装在专用服务器上。如果出现故障，还有一个恢复程序。在这种情况下，如果我们知道恢复密钥，我们甚至可以在不同的服务器上执行刷新。还要记住，当用户关闭时，个人网关会中断刷新功能。借助 Power BI 企业网关，我们可以实现每周 7 天、每天 24 小时的持续更新。内部数据网关通过使用 Azure 服务总线的通道工作，类似于个人网关的工作方式。Azure 服务总线为我们提供了与数据源(如分析服务)交互的能力。网关允许我们接受查询来源的账户。在连接到分析服务数据源的特定情况下，我们可以接受所谓的有效用户名。网关将接收用户并代表特定用户执行查询，查询结果仅取决于更新 Power BI 报告的用户。内部数据网关的另一个重要方面是，它允许我们以集中的方式管理数据源。安装内部数据网关的用户是数据源的管理员。此外，管理员可以添加其他管理员并设置不同类型的数据源，如 SQL Server、数据库 Oracle 和许多其他数据源。可以根据目标用户设置对数据源的访问。作为管理员，我们可以决定只有一类用户能够访问该特定数据源，而其他用户则不能。