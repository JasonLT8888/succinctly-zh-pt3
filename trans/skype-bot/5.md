# 第五章出版

## 快速介绍

我们现在已经探索了 Skype Bots 编程最有趣的特性，比如 LUIS、QnA Maker 服务和 Scorables——非常酷的 API 和开发范例。

我们所缺少的只是将我们的最新示例发布到 Skype 并在那里进行测试——这就是我们现在要做的。准备，准备，开始！

## 发布到 Skype

注册并发布一个机器人到 Skype 是非常容易的。首先，用你的微软账号登录 Bot 框架开发者门户，点击**我的 Bot**。

![](../Images/image063.jpg)

图 5-a:机器人框架开发者门户

登录后，点击**注册**，开始向 Skype 注册我们的机器人。这个过程非常简单直观(这在我的另一本书《T2》中也有深入的解释——简洁的微软机器人框架)。

如图 5-b 所示，我们需要输入几个字段，但最重要的是**消息传递端点**，这是我们的机器人将驻留的公共网址。

![](../Images/image064.jpg)

图 5-b:将我们的机器人发布到 Skype 所需的字段

为了获得我们的机器人的公共网址，我们需要在 Visual Studio 中打开**解决方案资源管理器**，右键单击项目名称，然后单击**发布**。然后，我们将看到一个非常直观的向导。我们将被要求提供一些信息，以便向导能够创建将托管机器人的 Azure 应用服务。

我们这里不赘述整个过程，您可以在图 5-c 中看到选择**发布**选项后，发布向导的主屏幕是什么样子的。

![](../Images/image065.jpg)

图 5-c:Visual Studio 中的发布向导

在图 5-d 中，我们还可以看到发布过程正在发生。

![](../Images/image066.jpg)

图 5-d:发布过程

一旦发布过程完成，我们就可以获得机器人的公共网址，如图 5-e 所示

![](../Images/image067.png)

图 5-e:发布成功

非常重要的是，在指定消息端点时，我们添加 **/api/messages** ，并确保使用 **https** 。

![](../Images/image068.png)

图 5-f:机器人的消息传递端点

一旦我们在 Bot 框架开发者门户上填写了所有需要的数据，点击表单底部的**注册**来完成这个过程。

默认情况下，机器人框架会自动将机器人部署到 Skype 和网络聊天频道。要在 Skype 中测试这个 bot，我们只需要点击 Bot 框架开发者门户页面上的 **Skype** 图标，如图 5-g 所示。

![](../Images/image069.jpg)

图 5-g:机器人开发者门户网站上的“试用 Skype”按钮

一旦你点击 **Skype** 图标，你将被要求将机器人添加到你的联系人中。

![](../Images/image070.jpg)

图 5-h:“添加到联系人”选项

接下来，您将看到一个浏览器弹出窗口，要求您**打开 Skype** 。

最后，机器人将被添加到您的 Skype 联系人列表中。您将被要求在 Skype 应用程序中确认您希望将机器人添加到您的联系人列表中。就这样，现在让我们做一个快速测试。

## 在 Skype 上测试

现在我们已经将这个机器人添加到 Skype 中，我们可以运行一个快速测试来看看它是否如预期的那样工作。因为我们已经在模拟器上对它进行了广泛的测试，并且没有更改代码，所以事情应该以与模拟器相同的方式工作。

所以，让我们简单地输入一些关键词，看看机器人会有什么反应。

![](../Images/image071.png)

图 5-i:在 Skype 上测试我们的机器人

看起来很酷！但是等等，机器人似乎没有给出任何答案。原因是我们忘记了在我们的 Visual Studio 项目中将 bot 框架开发人员门户中的 Bot 应用程序 ID 和密码添加到 *Web.config* 文件中。

代码清单 5-a:网络配置文件的应用程序设置部分

```
  <appSettings>
      <!-- update these with your BotId,
  Microsoft App Id and your     
       Microsoft App
  Password -->
      <add key="BotId" value="" />
      <add key="MicrosoftAppId" value="" />
      <add key="MicrosoftAppPassword" value="" />
  </appSettings>

```

让我们输入`BotId, MicrosoftAppId, and MicrosoftAppPassword`的值。

`BotId`为机器人手柄， `MicrosoftAppId`为 App ID， `MicrosoftAppPassword`为自动生成的密码。

我们可以通过点击**设置**然后**管理微软应用程序 ID 和密码**从开发者门户获取这些值。

![](../Images/image072.jpg)

图 5-j:机器人的应用程序标识和密码

假设您在开发人员门户上使用了与 Visual Studio 项目和 Azure App 服务相同的机器人名称，则`BotId`将是 Visual Studio 项目的名称。

输入值后，在 Visual Studio 中保存更改并再次发布机器人。然后，转到 Skype，再次测试机器人。键入**版权所有**。

![](../Images/image073.png)

图 5-k:再次在 Skype 上测试我们的机器人

现在我们做生意了！请随意进一步尝试，但请记住，结果将与我们使用模拟器进行测试时相同。

我们已经走到了旅程的终点——但在结束之前，我想以一些评论来结束我的发言。

## 闭幕词

这是一次非常有趣的探索之旅——我们扩展了在*微软机器人框架简明*一书中学到的概念，并研究了将机器人提升到下一个水平的 API 和技术。

Skype 是微软的首要通信工具，也是世界上最受欢迎的通信平台之一。

机器人已经开始为企业增加价值，改善用户和公司的体验。随着生态系统的不断发展，新的 API 有很大的潜力来进一步丰富这个平台。

还有很多我们在本书中没有涉及的 Skype 应用程序接口，我邀请您探索其中一些最新的应用程序接口——仍然处于预览模式——例如支付和加载项，这可能会使用户的对话体验更加愉快。

这本书为你继续探索这个庞大的生态系统所提供的所有惊人的可能性奠定了坚实的基础。

我希望你喜欢这本书，希望它帮助你更深入地研究 Skype 的发展——无论是为了娱乐还是商业目的。

感谢阅读并简洁支持*系列。要牛逼！*