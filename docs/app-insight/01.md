# 一、引言

如果你的公司的成功与网络应用程序或网络服务的可靠性和正常运行时间有关，你的强制性任务是跟踪它发生了什么。

完全控制它尤其重要，这需要了解三个不同的方面:

*   **可用性**:如何从不同的地理区域访问您的网络应用程序(或服务)。
*   **性能** : 你的 web 应用(或服务)是如何工作的，它的哪些部分表现最好，哪些部分表现最差。
*   **用法**:人们如何使用你的 web 应用(或服务)，哪些部分更受赞赏。

为了实现这些点，我们可以使用应用洞察，一种在微软 Azure 平台上可用的服务。

借助 Application Insights，我们可以监控每一种网络应用程序，即使它是一个网络门户或网络服务。

用于开发被监控的网络应用程序的技术或编程语言是不相关的，因为许多 SDK 是可用的。这意味着我们可以涵盖所有可能的组合。

关于 Application Insights 需要了解的一件重要事情是，我们可以监控 web 应用程序或服务，而不管它们的宿主是什么。这意味着我们可以使用 Application Insights 来检查 ASP 的运行状况。基于. NET 的 web 应用程序托管在微软 Azure 上，就像 PHP 网站托管在 Apache web 服务器上一样。

因此，尽管该服务是微软 Azure 的一部分，但我们不需要在其上托管我们的 web 应用程序来使用 Application Insights。

这种服务并不新鲜；网络上还有很多类似这样的服务，通常被称为网络分析软件(WAS)。

在这个分类中，你会发现其他软件工具，如[谷歌分析](https://www.google.it/intl/en/analytics/analytics/)、 [Matomo](https://matomo.org/) (以前的 Piwik)、 [Statcounter](https://statcounter.com/) 等。

无论如何，微软关于应用洞察的文档的官方分类是应用性能管理(APM)。

最终，无论它被分类，这项服务的意义不会改变:它是一项遥测服务。

| ![](img/note.png) | 注:遥测是一种自动通信过程，通过这种过程，测量值和其他数据在远程或无法到达的点收集，并传输到接收设备进行监控。(来源:[维基百科](https://en.wikipedia.org/wiki/Telemetry)) |

我第一次听说遥测技术是在看一场 f1 赛车比赛的时候。当时发言人提到 有了这项技术，赛车队就能够在比赛的每一个瞬间，控制赛车的所有至关重要的参数，比如胎压、燃油油位、刹车效率、发动机温度等等。所有这些值都以实时数据流的形式出现在团队经理的屏幕上，显示在网格或图表上。

让我解释一下，为什么在我看来，这是一个类似于 web 应用程序的场景。假设你领导着一个赛车队(你的公司)，你有一辆速度快、价格实惠的汽车(你的产品)，你雇佣了一名专业车手(你的开发团队)来赢得与竞争对手(市场)的比赛。

你需要遥测技术，你需要数据流，实时了解发生的变化，以便评估比赛状态和你的赛车运行的条件，应用必要的修正来达到最佳表现，或者到达终点。

如果你错过或没有正确评估这些信息，你的车的发动机可能会在比赛中途坏掉，或者发生其他事情，它可能永远不会到达终点线。

这项服务诞生于几年前。在其第一个版本中，它是 Team Foundation Services Online(今天称为 [Visual Studio Team Services](https://www.visualstudio.com/) )的一部分，其主要范围是不仅为网络应用程序，还为移动应用程序提供遥测。

过了一段时间，该服务成为了微软 Azure 的一部分，现在，该服务的重点已经局限于 web 应用程序。

2016 年上半年，专门针对移动应用的遥测服务被创建。这项服务被称为 [HockeyApp](https://hockeyapp.net/) 。

几个月后，微软宣布推出 HockeyApp Bridge 应用。它使您能够通过其**分析和连续导出**功能访问应用洞察中的 HockeyApp 收集的数据。

如前所述，可用性、性能和 web 应用程序(或服务)的使用是 Application Insights 最重要的三个目标。

但是在这三个目标的背后，还有更多方面需要考虑，我们将在这里介绍。

当我们监控可用性时，我们希望了解:

*   如果我们的网络应用已经启动并运行。
*   如何从不同的地理位置访问我们的 web 应用程序，以便了解我们感兴趣的投资市场。

让我举个例子:我们有一家生产短裤的公司，我们想通过一个遍布全球的网络商务网站来销售这些短裤。托管该网站的服务器位于爱尔兰。

考虑到产品的性质，我们将在一年中最热的季节销售更多，但季节会根据大陆而变化。因此，我们可以观察来自全球最热地区的用户访问我们网站的时间。

从这些数据出发，我们可以发现:

*   该网站在合理的时间内无法访问。例如，来自东京的用户必须等待三秒钟才能打开主页，最多五秒钟才能进行目录搜索。
*   自上周以来，游客数量有所增加，这一趋势在远东地区非常有趣，尤其是来自中国和韩国的游客。

记住这一点，我们可以选择在地理上复制我们的网站，在一个更容易到达的位置为我们的潜在客户，如日本。

这种决定在云时代非常容易，网站管理员只需点击几下鼠标就可以修改地理复制，并在几分钟内完成排序。但重要的是要知道把钱投资到哪里，因为地理复制可能不贵，但最终它不是免费的。

使用网络商务网站场景，我们应该调查我们的网站的性能，以给我们的潜在客户最好的用户体验。

在我们的示例中，我们应该能够确定网站中哪些页面或功能会降低我们的目录搜索速度。也许我们可以在我们的搜索算法或我们集成到平台中的外部服务中发现一个瓶颈。

### 用法

在我们的投资计划中，我们必须估计努力(关于金钱和时间)，以确定实现我们期望的业务增长的最佳方向。

为了达到这个目标，我们需要了解我们网站的使用情况，也就是用户如何在网站上花费时间。例如，我们应该知道他们是否更喜欢使用过滤器搜索目录，或者浏览照片库而不是产品详细信息页面，或者当他们在主页上发现活动促销时，他们是否访问了促销页面。

这些数据可以影响我们未来投资的很大一部分。举个例子，如果我们知道我们的访问者通常会欣赏我们低估的页面，我们可以投资于该页面或功能的增强，而不是再投资于另一个对我们的潜在客户来说更贵、吸引力更低的页面。

在本书中，我们将浏览应用洞察资源的可用特性。我们不会涵盖所有这些，但这将是理解应用洞察能力的良好起点。