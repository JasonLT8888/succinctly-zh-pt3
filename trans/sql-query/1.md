# 一、简介

SQL 是数据的语言。数据是商业语言，因为每一个企业都离不开数据。我们可以说，SQL 是业务的语言，或者至少它是我们这些跨越技术和业务之间界限的人的中介语言。

很难想象没有数据库的业务应用程序。无论您是在处理在线事务处理(OLTP)、在线分析处理(OLAP)还是临时查询，SQL 都是将数据移入和移出数据库的关键。对于门外汉甚至普通用户来说，SQL 看起来就像魔法。SQL 是第四代语言(4GL)。这意味着，与大多数编程语言不同，我们不会告诉数据库如何做需要做的事情。我们描述需要做什么，并离开数据库来决定如何最好地完成我们的请求。

SQL 允许我们描述我们需要的数据。数据库决定使用哪些索引，如何将数据连接到各种相关的表中，如何从磁盘中读取，如何隔离脏数据，等等。

如果启动得当，我们可以自己施展这个魔法。

我们将介绍如何将数据放入数据库，更新已经存在的记录，以及删除不再需要的数据。我们将以你能想象的任何方式对数据进行切割。我们将看到如何跟踪跨表的关系，以及如何应用过滤器来查找相关数据。我们将使用内置的聚合函数来汇总数据，并着眼于解决日期和时间值的常见问题，以及导航分层数据的各种方法，如组织结构图、销售层次结构等。

通常，创建查询最困难的部分是理解正在使用的数据模型，因此我们将通过探索数据字典来完成。这保存了数据库跟踪的关于存储数据的所有数据。我们将使用这些视图来获取任何数据库中每个表中每个列的详细信息。这可以大大缩短学习新数据模型的学习曲线。

这本书的重点将是 ANSI SQL，但是许多供应商对 ANSI 标准的支持程度各不相同。本书中给出的所有示例都已针对 SQL Server 2012 进行了测试。大多数示例都适用于 SQL Server 2008R2。在解释示例时，会注意到少数需要新版本的情况。

您可以在这里下载免费版的 SQL Server 2016 Express [。](https://www.microsoft.com/en-us/download/details.aspx?id=52679)

一般来说，SQL 是一个很大的话题。在这里，我们将着重于使用语言本身。出于必要，边缘的几个主题将不会被涵盖，尽管这些主题中的每一个本身都非常重要。

我们将忽略数据库管理的大多数问题。我们将跳过硬件和基础设施问题，忽略冗余和容错的关键问题。我们将只简单地提到性能，以展示如何重新排列查询来提高性能，并讨论一些常见的问题，这些问题可能会导致数据库为了获得我们感兴趣的数据而比它应该做的更努力。

安全是每个人都关心的问题，但在这本书里，我们将把这种关心放在一边。要知道保护数据是每个人的责任。深度防御需要在业务应用程序的用户界面提示中进行验证和适当的约束，在用户界面中不能绕过的业务逻辑中进行验证，以及在数据库中进行适当的约束。这些都很重要，但这里不直接讨论。

数据库约束和检查是数据建模的领域，我们也将跳过它。在我们的每一次讨论中，我们都将使用数据模型，但我们不会深入研究数据模型是如何创建的，或者哪些替代结构可以使用。在许多情况下，我们将使用不太理想的数据模型，承认我们经常无法使用理想的数据模型。现实情况是，我们经常被我们拥有的数据库所困，这个数据库的发展和变化经常超出了它最初的设计。

| ![](img/00003.gif) | 注意:我们将在适当的时候强调约束和检查的重要性，但仍然接受这样一个现实，即我们大部分时间不得不使用现有的数据库，并且我们很少从头开始设计新的数据库。 |

在这一介绍性章节中，我们已经了解了 SQL 的本质及其在现代商业应用程序中的重要性。我们已经看到了我们将在本书中涵盖的内容的概述，以及我们将跳过的一些主题的部分列表。即使我们跳过这些话题，它们仍然很重要。我建议您将此视为学习 SQL 的第一步，并跟进我们将跳过的一些附带主题。

现在让我们从标准 SQL 操作可以采取的一些最简单的形式开始。