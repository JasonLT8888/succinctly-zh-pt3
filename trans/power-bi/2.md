# 第二章服务

Power BI 不是我们安装的产品，而是在微软云中执行的产品，我们可以在不同的界面中使用。

该服务允许我们:

*   简单快速的数据访问
*   完整的业务实时视图
*   搜索和发现数据(以便创建仪表板和报告)
*   任何设备的数据分析
*   组织内共享
*   公司范围内的数据显示和分析

## 数据来源

有许多类型的数据源:

*   SaaS 解决方案，例如 Marketo、Salesforce、GitHub、谷歌分析、CRM Online
*   内部数据，例如，SQL Server 分析服务
*   组织内容包，例如公司数据源或外部数据服务
*   Azure 服务，例如，Azure SQL、流分析
*   Excel 文件，例如工作簿数据/数据模型
*   强大的商务智能桌面文件，例如来自文件、数据库、Azure 和其他来源的数据

组织内容包在数据源中非常突出。它们提供了一种在公司内部共享数据的简单直观的方式。

Power BI 通过 RESTful API 引入了一个程序接口，该接口允许直接与服务交互，构建数据集，并在必要时将我们的 Power BI 可视化作为网络应用程序导入我们的应用程序中。

为了尝试 Power BI，您可以免费注册该服务。但是一定要注意并使用 Office 365 电子邮件地址，该地址必须以域名 microsoft.com 结尾(您也可以使用公司电子邮件帐户)。来自 gmail.com、live.com、hotmail.com 和 outlook.com 等许多公共服务器的电子邮件帐户不允许注册。

注册后，您可以测试功能。只需订阅 Power BI Pro，就可以随时更新许可证。

## 支持的浏览器和移动应用

因为它是一项在线服务，我们可以直接从浏览器，通过支持的网络浏览器或移动应用程序使用 Power BI。支持的浏览器版本有:

*   微软边缘
*   Internet Explorer 11
*   Chrome 桌面，最新版本
*   Safari Mac，最新版本
*   Firefox 桌面，最新版本
*   Power BI(适用于较旧的浏览器版本，但可能存在渲染问题)

除了浏览器，我们还可以使用这些移动应用:

*   Windows 操作系统
*   iOS (iPhone 和 iPad)
*   机器人
*   Windows Phone 10

支持的功能有:

*   最重要的可视化效果的收藏夹栏的定义。
*   放大/缩小可视化效果。
*   可视化和快照共享的注释。
*   用于接收关键业务关键绩效指标报告的警报配置。

## 积木

Power BI 由“瓦片”组成，这是 Power BI 的主要元素。被称为“积木”，它们是:

*   **数据集**:作为分析对象的数据集合。
*   **报告**:允许我们以不同的方式查看我们的数据，这可以给我们更大的洞察力，让我们得出更深刻的结论。
*   **仪表盘**:这些让我们可以一目了然的监控最重要的数据。我们可以通过锁定机制选择要发布到仪表板的可视化/报告，并将它们组合起来，以便对业务进行一瞥。

![](../Images/image004.png)

图 4:仪表板示例

可以使用导航窗格创建或选择感兴趣的元素或构建块。

![](../Images/image005.jpg)

图 5:构建模块

请注意，仪表板在单个画布中显示切片。

单幅图块来源于报告中单个显示的固定或问答回答。

仪表板可以基于一个或多个数据集。

图块可以调整大小，也可以更新。

如图 6 所示，您可以使用问答在仪表板上用自然语言提问。

![](../Images/image006.jpg)

图 6:问答字段

为了连接到数据集，仪表板必须至少包含一个切片。

仅支持与当前仪表盘关联的基于云的数据集。Q & A 为问题的制定提供支持，Q & A 也为问题设置了建议、自动完成甚至更正的格式。请注意，仅支持基础英语的问题。在基本模型中使用有意义的名词效果最好。

报表从数据集开始构建。显示模型，我们直接在报告中从数据集中选择数据。

电力商业智能服务由以下几个部分组成，如图 7 所示。

![](../Images/image007.png)

图 7:电力商业智能服务

*   导航栏
*   带瓷砖的仪表板
*   问答问题箱
*   帮助和反馈按钮
*   仪表板标题
*   Office 365 应用程序启动器
*   电源商务智能主页按钮
*   其他仪表板操作

## 服务类型

事实上，Power BI 服务是我们可以通过一组功能访问的特定服务。它提供了许多功能并且是免费的，所以我们称这个版本为“freemium”。同样的服务还有付费版，Power BI Pro，没有 freemium 版的限制。

![](../Images/image008.png)

图 8:电力商业智能许可

请注意，“发布到网络”选项在两个版本中都是免费的功能。然而，数据更新和两个版本的合作各不相同——有了付费版本，数据可以以非常高的频率更新。此外，付费版有 10 GB 的空间用于数据存储和处理，而免费版只有 1 GB。

有了付费版本，我们每天可以进行超过八次的计划更新。有了免费版本，更新一天只能进行一次。

## 一个例子

让我们从零开始。我们导入一个我们可以从该网站下载的数据示例:【Power BI 的财务示例工作簿。请注意，可以从以下位置加载数据:

*   我的组织
*   服务
*   文件(直接来自系统文件)
*   数据库

从系统文件上传数据，在我们的例子中是一个 CSV，[Power BI 的财务示例工作簿](http://go.microsoft.com/fwlink/?LinkID=521962)，数据模型被快速导入，几秒钟内就可以使用。

这些字段由 Power BI 自动识别。

图 9 显示，如果您将 Sales 字段拖到报告的白色页面，Power BI 将以它认为当时最合适的方法显示数据。

![](../Images/image009.png)

图 9:电力商业智能显示数据

如果您将 year 字段拖到图表中，如图 10 所示，您将立即注意到 Power BI 通过添加 Year 对可视化进行了修改。

![](../Images/image010.png)

图 10:电力商业智能显示数据

我们可以将年份移到横坐标字段，看看 Power BI 现在如何通过考虑修改来改变可视化，如图 11 所示。

![](../Images/image011.png)

图 11:电力商业智能显示数据

我们可以通过将“月”字段放在“年”字段下(在 x 轴部分)来实现向下钻取。通过单击带有“向下”箭头的圆形图标，可以进行向下钻取。如果我们通过单击年份来分析数据，可视化也会通过显示月份来改变。

![](../Images/image012.png)

图 12:电源商业智能显示数据—序列

请注意，通过双击某一特定年份，我们可以进入细节。

如果我们想进行可视化，我们必须单击“向上钻取”图标。

![](../Images/image013.png)

图 13:电力商业智能显示数据

之后，我们添加另一个可视化工具——切片器。

![](../Images/image014.png)

图 14:电源商业智能显示数据—切片器

接下来，正如我们在图 15 和 16 中看到的，我们选择了 Segment 字段并将其拖动到切片器中。

![](../Images/image015.png)

图 15:电力商业智能显示数据—切片机的使用

![](../Images/image016.png)

图 16:电力商业智能显示数据—切片机的使用

我们可以通过注意切片器中值的选择如何影响相邻的可视化来与报告进行交互。

![](../Images/image017.png)

图 17:电力商业智能显示数据—切片机的使用

现在我们创建一个新的仪表板并保存报告，如图 18 中的三个图形所示。

![](../Images/image018.png)

![](../Images/image019.png)

![](../Images/image020.png)

图 18:功率 BI 显示—切片机数据—序列

保存报告后，我们可以选择阅读查看模式，通过点击**编辑报告**选项卡，可以与数据进行交互。通过返回到设计模式，我们可以通过单击 Pin 图标来更改想要修改的信息。

![](../Images/image021.png)

![](../Images/image022.png)

图 19:固定到仪表板—顺序

接下来，我们添加已经固定到新仪表板的图表。

![](../Images/image023.png)

图 20:平铺

当操作完成后，我们会注意到一个图块，这是我们固定在仪表板中的图形。通过单击切片，我们以阅读视图模式打开原始报告。

锁定报告的另一种模式是返回同一编辑页面，缩小它，然后单击屏幕右上角的**锁定实时页面**。该报告将被固定在仪表板上。这种模式很重要，因为它允许我们通过切片器与数据进行交互。

![](../Images/image024.png)

![](../Images/image025.png)

![](../Images/image026.png)

图 21:固定活动页面—序列

如果我们要从仪表板中删除切片，我们可以单击省略号图标(…)来指示上下文菜单是否可用。在下面的可视化中，我们单击删除条目。

![](../Images/image027.png)

图 22:仪表板

在上下文菜单中，我们还可以执行其他操作，例如将图形打开到全屏的焦点模式，以及也将图形打开到全屏并提供重要值(如值总和和摘要图表)的 Insights。

![](../Images/image028.png)

图 23:见解

我们还可以使用“视觉锁定”图标将同一个图块锁定到另一个仪表板中。“导出数据”允许我们导出图块中的数据(CSV 格式)。

使用图 24 所示的“图块细节”，显示了另一个窗口，我们可以在其中编辑图块的信息。

![](../Images/image029.png)

图 24:图块细节

正如我们在图 25 的报告的编辑页面中所看到的，如果我们点击左下角的一个新页面，我们可以向报告中添加新页面。如果我们探究各个字段，我们会注意到数据集的国家字段由一个小地球仪表示。Power BI 可以识别数据类型，如果我们将它拖到报告中，它将被识别为地理数据，因此将显示地图。当我们将“销售”字段拖放到地理地图时，会显示地图上的销售分布。

![](../Images/image030.png)

图 25:电力商业智能可视化

图 26 显示，我们可以通过插入 Sales 字段在同一页面上添加一个新的图表，并且在同一图表中，我们可以添加 Month 字段，以便有一个时间基础。通过单击图形类型，我们可以将可视化更改为最符合我们预期的可视化。

![](../Images/image031.png)

图 26:电力商业智能可视化

## 视觉画廊

如果视觉效果不够，我们可以从 https://store.office.com/en-us/appshome.aspx?的视觉画廊获得新的视觉效果 productgroup=PowerBI ，在这里我们可以看到许多已经实现并共享它们的人发布的可视化。

![](../Images/image032.png)

图 27: Power BI 视觉画廊

如图 28 所示，我们还可以下载时间轴。请注意，检查可以不断更新，因此建议总是下载它们，以确保您有更新的版本。为此，单击**添加**，然后单击**选择**下载时间线切片器。

![](../Images/image033.png)

![](../Images/image034.png)

图 28:电源 BI 时间线切片—序列

我们通过单击“...”来导入此新控件可视化部分中的图标。

![](../Images/image035.png)

图 29:电力商业智能可视化

时间线可视化将在显示命令上可用。通过将时间线添加到报告中，然后将数据字段拖到那里，我们可以实现一个控件，允许我们基于时间间隔选择数据。简单直观。报告中的其他可视化将根据通过时间线进行的选择显示数据。

![](../Images/image036.png)

图 30:强大的商业智能可视化——自定义视觉效果的使用

请注意，因为自定义视觉效果是由第三方开发的，所以它们包含一个免责声明，要求我们进行使用确认。

![](../Images/image037.png)

图 31:自定义视觉使用条款

图 32 展示了从视觉图库下载自定义视觉效果。我们可以通过将“国家/地区”字段拖到新页面上来添加报告，然后再拖到“销售”字段上。这样做将创造一个舞台形象。

![](../Images/image038.png)

图 32:自定义视觉的使用

报告页面是独立的。我们可以根据页面或报告设置某些过滤器。基于页面，数据仅在页面上被过滤，因此可视化将仅显示通过过滤器的数据。在报告的基础上，所有报告页面中的可视化将显示通过该过滤器的数据。在图 33 中，段字段已经被选中并链接到一个报告级过滤器。所有页面将基于过滤后的数据进行交互。

![](../Images/image039.png)

图 33:过滤器的使用

## 自然语言能力

我们可以根据正在分析的数据模型向 Power BI 提出问题。

例如，在询问“哪个细分市场的收入最多？”术语“最”告诉 Power BI，我们要求的是一个系统。

![](../Images/image040.png)

![](../Images/image041.png)

图 34:问答顺序的使用

“哪个细分市场获得的利润最多？”会通过图像得到答案。如果我们对图形形式不满意，我们可以通过选择最让我们满意的可视化来改变它。我们可以直接在仪表板中进行固定。通过点击刚刚插入的图块，我们可以回到最初的问题。请注意，我们的数据模型中没有收入，但 Power BI 已经意识到这与利润字段相关，并向我们显示了利润。

## 分享与合作

共享与合作可以通过三种不同且互补的方法来实现:

*   直接与我们组织的用户共享仪表板和切片。
*   使用 Office 365 组:在专用于该组的工作区中直接报告和协作。
*   发布组织内容包，在内部图库中显示(组织或组织内部的组的所有用户都可以在商店中冲浪，显示内容包，并且可以安装具有相同使用体验的相关包)。

每种方法都要求所有用户都拥有 Power BI Pro 许可证。除了数据集内部分析服务案例之外，所有用户都将看到相同的共享数据。

表 1:股票期权比较

|  | 分享 | 365 集团办公室 | 组织内容包 |
| 目的 | 特别的 | 合作 | 大型内容交付 |
| 目标受众 | Office 365 通讯组的个人或成员。通常适用于严格协同工作且需要显示特定仪表盘或图块的用户。 | Office 365 组的成员。一般适用于从事一个项目或在一个共同范围内的团队和合作者。 | 整个组织、安全组和/或 Office 365 组的成员或单身者。适合所有可能对特定内容感兴趣的人。 |
| 它适用于: | 特定仪表板或图块 | 所有的内容 | 所有的内容 |
| 发现 | 邀请电子邮件 | Office 365 组 | 获取数据→内容库 |
| 许可 | 只读不可见数据集。报告在阅读视图中。可以批准换证。 | 编辑。该组的所有成员在管理组内容方面具有相同的权利。 | 主要是只读。成员可以解锁以个性化他们的副本。必须更新的个性化内容包将发出通知。 |

有些函数比其他函数更适合特定的上下文。例如:当我们必须在很短的时间内与合作者共享仪表板时，共享仪表板非常有用。在这种情况下，我们必须插入合作者的帐户—我们将收到通知，并且能够显示仪表板—但是我们将无法修改工作。在协作组的上下文中，我们可以通过工作区使用协作方法，所有用户都可以修改报告和仪表板，作为一个团队协作编写报告。简而言之，内容包非常适合多人使用数据的情况，因为我们在包中发布包(包括仪表板、报告和数据集)，并将其发布到对组织的所有用户可见的库中(因此用户可以自由安装和修改)。

### 合作

为了配合，我们必须进入仪表盘点击**分享**。

![](../Images/image042.png)

图 35:仪表板

接下来，我们指出要共享仪表盘的用户，并点击**共享**。

![](../Images/image043.png)

图 36:共享仪表板

在同一个共享页面上，我们将找到指定用户是否可以与其他用户共享仪表板的选项。我们也可以选择通过电子邮件发送通知(或不发送)。

在合作示例中(其中选项 1 为否，选项 2 为是)，接收共享仪表板的用户将无法修改它，只能显示它。

我们可以取消与特定用户的共享，方法是在访问部分选择**共享**，然后单击**取消邀请**。

关于通过 Office 365 组的合作，在屏幕的左上角，我们会看到条目“我的工作区”，表明这是我们的个人工作区。

我们可以浏览查看是否有几个组工作区。如果没有，我们可以通过指定组的名称来创建一个新的组，无论该组是私有的还是公共的，并且如果该组的所有成员都能够修改工作区内的内容或仅显示它们。最后，我们包括属于工作区的用户。

![](../Images/image044.png)

图 37:仪表板

![](../Images/image045.png)

![](../Images/image046.png)

图 38:共享仪表板进行合作—顺序

我们可以通过选择一个组工作区回到共享。我们获得了一套新的三重仪表板、报告和数据集，它们独立于个人数据集。在这个新的工作空间中，我们能够与属于 Office 365 组的其他人合作。

我们也可以分享我们在网上写的报告。

假设我们允许默认匿名访问报告，那么在网上发布报告可以让任何人看到报告。

从报告中，我们点击**文件**，然后**发布到网络**。

![](../Images/image047.png)

图 39:发布到网络

图 40 显示了我们接下来的动作顺序——选择**创建嵌入代码**，然后**发布**。

![](../Images/image048.png)

![](../Images/image049.png)

图 40:发布到网络—序列

新窗口(图 41)将显示几个项目:我们可以通过电子邮件发送的链接；我们可以粘贴到博客或网站上的 HTML 和 HTML iframe 标签，我们可以将它们集成到我们的 web 应用程序中。请注意，图形的大小以像素为单位，我们可以从三个不同的维度中进行选择。

![](../Images/image050.png)

图 41:发布到网络—完成发布步骤

图 42 描述了可用的尺寸选择。

![](../Images/image051.png)

图 42:发布到网络—完成发布步骤

如果我们通过在浏览器的网址中指定链接来使用它，我们将可以直接访问我们的报告，并且可以在没有身份验证的情况下浏览它。

![](../Images/image052.png)

图 43:发布到网络-结果

## 导入数据源:焦点

通过 web 界面登录数据源非常简单。

我们通过点击**获取数据**来选择我们想要使用的数据源类型。

在内容包中，我们可以为数据指定四种不同来源之一:

*   组织的
*   SaaS 应用程序(包括文件)
*   Excel 工作簿
*   通过 Power BI 桌面应用程序生成的文件(云中存在的数据库和数据服务)

Excel 文件可以直接从浏览器导入，也可以从本地源加载，或者我们可以访问 OneDrive for Business、OneDrive Personal 或 SharePoint 团队网站。

OneDrive/SharePoint 中的文件更新会在报告和仪表板中自动识别，数据将保留在工作簿中。如果工作簿连接到外部数据源，我们可以使用 Power BI 进行刷新。

支持的文件类型:

*   高级商务智能桌面文件
*   Excel 工作簿
*   CSV 文件

![](../Images/image053.jpg)

图 44:获取数据

上传文件的最大大小为 250 兆字节(对于工作簿中的数据模型为 240 兆字节，对于工作簿中的其余部分数据为 10 兆字节)。

如果 Excel 文件在 OneDrive Personal/For Business 或 SharePoint 团队网站中，除了导入之外，我们还可以连接到 Excel 工作簿，该工作簿将有自己的生命(它所在的位置)。数据导入后，我们还可以使用刷新函数来更新数据集。

在导入 Excel 工作簿的过程中，数据模型中包含的所有内容都将转换为数据集。在这种特殊情况下:

*   数据模型的内容优先于工作表级别的内容。
*   工作簿数据模型将被转换为 Power BI 数据集。
*   工作簿表将被转换为高级商务智能数据集。
*   电源视图表将被转换为电源商业智能的页面。
*   无法识别数据透视表、数据透视图和自定义字段。

工作簿中的数据只有在定义为表时才会被导入。Power BI 将忽略工作簿中分散的数据。

![](../Images/image054.png)

图 45:在线 Excel—Excel 表格示例

图 46 显示了如何查找 Excel 表格。

![](../Images/image055.jpg)

![](../Images/image056.jpg)

图 46:在线 Excel 数据透视表图表—序列

![](../Images/image057.png)

![](../Images/image058.png)

图 47:导入 Excel 文件—序列

请注意，工作簿被转换为各种 Power BI 内容，这些内容是逐渐创建的。导入单个内容后，它将出现在相应的部分(报表、数据集)。

通过显示数据集，我们可以看到 PowerPivot 数据模型中的表是如何转换为 Power BI 数据集的，以及所有的列是如何报告的。

![](../Images/image059.jpg)

图 Excel 文件中的字段

将创建一个报告，其中包含一个页面(带有导入的超级视图工作表的名称)和我们在工作簿的超级视图工作表中看到的相同图形。

我们可以编辑内容或创建新的图表，并将它们一起用于创建仪表板。该内容将被识别为功率商业智能图。

这里有一个关于 OneDrive 的示例:

首先，选择一个 XLSX 文件。

将显示两个选项:

*   将 Excel 数据导入电力商业智能
*   在 Power BI 中连接、管理和查看 Excel

连接选项不会转换工作簿，而是将其嵌入到 Power BI 中。在左侧的导航窗格中，我们可以在带有 Excel 图标的报告中看到这一点。

通过选择它，我们现在可以在 Excel Online 中浏览 Excel 工作簿。

![](../Images/image060.png)

图 49:完成导入

此工作簿与 OneDrive 或 SharePoint 中的 Excel 的连接的价值在于设置数据刷新的可能性。如图 50 和 51 所示，我们可以通过选择一个表或表的一部分并在仪表板中进行固定来执行内容的固定。

![](../Images/image061.png)

图 50:Power BI 上的 Excel 工作簿

![](../Images/image062.png)

![](../Images/image063.png)

图 51:固定到仪表板—顺序

当我们单击仪表板中的图块时，我们会被重定向到带有 Excel Online 的 Excel 文件。