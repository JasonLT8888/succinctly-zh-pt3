# 第一章简介

## 什么是临朐？

LINQPad 是约瑟夫·阿尔巴哈里开发的一个软件实用程序，它旨在作为。NET 应用程序开发。它用于使用 LINQ 交互查询 SQL 数据库，以及交互编写 C#代码，而不需要集成开发环境(如 Visual Studio)。这个特性扩展了它作为“测试工具”的用途，在这里 C#代码可以在 ide 之外快速原型化。它还支持 VB.NET、SQL 和 F#语言。LINQPad 支持以下技术:

*   实体框架
*   从 LINQ 到物体
*   从 LINQ 到 SQL
*   LINQ 到 XML

该产品从 freemium 版本开始，缺少 C#语言的自动完成功能。要获得此功能，用户应该购买商业许可证。

无论许可的类型是免费的还是商业的，该产品都有三个版本:

*   LINQPad 2.x for。NET 框架 3.5
*   LINQPad 4 for。NET 框架 4.0/4.5。当前稳定版本:4.58.0
*   LINQPad 5 for。NET 框架 4.6:当前稳定版本:5.05.02

| ![](../Images/note.png) | 注意:LINQPad 5 可以和 LINQPad 4 并行运行。 |

## linqpd 版

LINQPad 产品有四个版本:免费版、专业版、开发者版和高级版。除了第一个，用户需要为使用产品支付许可费。根据购买的版本，LINQPad 除了免费版之外，还会解锁一系列附加功能。用户首先安装 LINQPad 的免费版本，然后购买许可证升级到免费版本之外的所需版本。该许可证适用于 LINQPad 4 和 LINQPad 5，因此用户不需要为每个版本付费。

| ![](../Images/note.png) | 注意:根据该产品的网站，在 2015 年 1 月 1 日之前购买 LINQPad 4 许可证的用户必须购买 LINQPad 5 的升级版。 |

下表根据使用的版本总结了 LINQPad 的所有可用功能。

表 1:临朐版本对照表

|  | 版本 |
| --- | --- |
| 特征 | 自由的 | 赞成 | 开发者 | 溢价 |
| --- | --- | --- | --- | --- |
| 运行 LINQ 查询或任何 C#/VB/F#表达式/程序 | 是 | 是 | 是 | 是 |
| 结果输出到富文本或数据网格 | 是 | 是 | 是 | 是 |
| 自动翻译成 SQL、fluent-lambda 和 IL | 是 | 是 | 是 | 是 |
| 引用用户自己的程序集，加上整个。NET 框架 | 是 | 是 | 是 | 是 |
| 自定义扩展、可视化工具和数据源提供程序的使用 | 是 | 是 | 是 | 是 |
| 完整的 C#/F#/VB 自动完成和工具提示 |  | 是 | 是 | 是 |
| 用于导入附加命名空间/引用的智能标记(C#/VB) |  | 是 | 是 | 是 |
| 代码大纲和自动格式化 |  | 是 | 是 | 是 |
| 重命名符号，转到定义并查找引用(C#/VB) |  | 是 | 是 | 是 |
| 内置和自定义代码片段 |  |  | 是 | 是 |
| 跨数据库查询 |  |  | 是 | 是 |
| 在网格中直接编辑 SQL 数据，并将更改保存回数据库 |  |  | 是 | 是 |
| 完全 NuGet 集成 |  |  | 是 | 是 |
| 集成调试器，带有调用堆栈、线程、局部变量/观察窗口、断点和单步执行 |  |  |  | 是 |

## 临朐的主要规格

LINQPad 为用户提供了一系列好处，例如:

*   在 LINQPad 5 中完全支持 C# 6.0 和 VB 14。
*   在其状态栏中报告执行时间，允许性能测试。
*   用组合键(Ctrl+Shift+C)克隆代码片段，允许它们并行执行。
*   自定义扩展编写，允许用户对方法和类进行编码，使它们可用于所有 LINQPad 查询。
*   自定义程序集引用。
*   动态构建类型化数据上下文，包括 SQL Server、SQL Azure、SQLCE、Oracle、SQLite 和 MySQL 的驱动程序和格式化程序。
*   使用嵌入式转储方法呈现对象。
*   用户自定义类型中 Dump 方法的访问控制。
*   lprun.exe 实用程序的完整命令行体验。
*   支持编写自定义可视化工具。
*   支持演示模式，以便允许无绳演示设备。

## 临朐是如何运作的

LINQPad 是一个以不同寻常的方式工作的客户机/服务器应用程序。虽然大多数客户机/服务器应用程序都有许多客户机和一台服务器，但是使用 LINQPad，只有一台客户机和多台服务器。在这种情况下，LINQPad 用户界面就像预期的那样是客户端，对于将要执行的每个查询，LINQPad 都会创建一个单独的服务器，该服务器有一个在自己的进程中运行的类。该进程独立运行查询。这种隔离可以防止查询相互干扰或干扰用户界面，并且它允许 LINQPad 在不影响其他应用程序域的情况下安全地取消查询。

LINQPad 使用一个定制的通信层，它运行在 Windows 共享内存之上，提供了一个更快、更可靠和完全异步的通信层。

微软罗斯林库用于在 LINQPad 5 中编译查询。关于数据库对象，LINQPad 需要一个类型化的数据上下文来支持查询中引用的任何数据库对象，因为 C#和 VB 是静态类型的。LINQPad 通过使用反射来动态构建这些类型化的数据上下文。出于性能原因，请发出而不是生成和编译源代码。此外，它使用 LINQ 到 SQL 而不是实体框架，因为 LINQ 到 SQL 在实例化时构建元模型更轻更快。

LINQPad 的排放引擎本身运行在一个独立的应用程序域中，因为反射。Emit 必须实例化内存中程序集无法卸载的类型。该域会定期刷新，以避免不断增加的内存占用。

LINQPad 的大部分工作都是在后台进行的，比如查询数据库模式、发出类型化的数据上下文以及编译和执行查询。出于这个原因，每个潜在的时间密集型特性都异步运行，以维护一个响应迅速的用户界面。

LINQPad 的`Dump`方法(将在后面讨论)将输出馈送到一个 XHTML 流中。该流使用嵌入式网络浏览器显示(用户可以通过右键单击查询结果并选择**查看来源**来注意到这一点)。LINQ 到 XML 用于将输出转换为 XHTML，作为一个 LINQ 查询。当用户点击超链接时，结果的延迟扩展和额外数据的获取是通过 JavaScript 实现的。

LINQPad 使用来自几个软件发行商的第三方库。其中包括 Actipro 的 SyntaxEditor、夏普开发项目、微软罗斯林和 NRefactory。这些发行商的库作为嵌入式资源包含在 LINQPad 中，因此它作为单个可执行文件提供。

LINQPad 的所有更新都下载到应用程序的数据文件夹中。然后，LINQPad 检查新程序集是否具有相同的强名称。如果是这样，LINQPad 会转发到该可执行文件，然后该可执行文件将自己写回原始文件。此操作可能会失败，具体取决于对下载 LINQPad 的文件夹的权限。每次启动时，LINQPad 总是会检查应用程序的数据文件夹中是否有自己的签名版本。

![](../Images/image002.jpg)

图 1:关于 LINQPad 如何工作的上下文图

## 章节总结

LINQPad 是约瑟夫·阿尔巴哈里开发的一个软件实用程序，它旨在作为。NET 应用程序开发。它用于使用 LINQ 交互查询 SQL 数据库，以及交互编写 C#代码，而不需要集成开发环境，如 Visual Studio。

LINQPad 支持 VB.NET、SQL 和 F#语言。另外，LINQPad 支持实体框架、LINQ 到对象、LINQ 到 SQL 和 LINQ 到 XML 方言。

该产品以 freemium 版本开始，该版本缺少几个功能，例如 C#语言的自动完成功能。无论许可的类型是免费的还是商业的，该产品都有三个版本:LinkPad 2 . x(for。. NET Framework 3.5)，LINQPad 4(针对。NET Framework 4.0/4.5)和 LINQPad 5(对于。NET 框架 4.6)。此外，每个版本都有四个版本:免费版、专业版、开发者版和高级版。

根据购买的版本，LINQPad 会自动启用免费版本中包含的所有功能之外的额外功能。其中一些功能包括完整的 C#/F /VB 自动完成和工具提示、C#/VB 的代码大纲和格式、内置和自定义代码片段以及完整的 NuGet 集成。

LINQPad 是一个客户机/服务器应用程序，它作为一个客户机和多个服务器工作。在这种情况下，正如预期的那样，LINQPad 用户界面是客户端，对于将要执行的每个查询，LINQPad 都会创建一个单独的服务器。对于客户端和服务器之间的通信，LINQPad 使用一个定制的通信层，它运行在 Windows 共享内存之上。

微软罗斯林库用于在 LINQPad 5 中编译查询。因为 C#和 VB 是静态类型的，所以所有的数据库对象都是使用类型化的数据上下文来支持的。所有的数据上下文都是通过使用反射来动态构建的。所有后台工作(查询数据库模式、编译和执行查询)都是异步运行的，以便维护一个响应迅速的用户界面。

LINQPad 在用户界面中使用来自几个软件发行商的第三方库。其中包括 Actipro 的 SyntaxEditor、夏普开发项目、微软的 Roslyn 和 NRefactory。这些库中的库作为嵌入式资源包含在 LINQPad 中，因此它作为单个可执行文件提供。

LINQPad 的所有更新都下载到应用程序的数据文件夹中。每次启动时，LINQPad 都会检查应用程序的数据文件夹中是否有其后来的签名版本。